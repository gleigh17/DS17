{"paragraphs":[{"text":"%pyspark\nfrom pandas import Series, DataFrame\nimport pandas as pd\nimport numpy as np\npeople = DataFrame(np.random.randn(5,5), columns=['a','b','c','d','e'], index=['Joe','Steve','Wes','Jim','Travis'])\npeople.ix[2:3, ['b','c']] = np.nan # Add a few NA values\npeople","user":"anonymous","dateUpdated":"2017-03-23T18:04:25-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"               a         b         c         d         e\nJoe    -0.000421  1.373888  0.157108 -0.639893 -0.535251\nSteve  -0.752337 -0.531799 -0.426532  0.553767  1.140440\nWes     1.042815       NaN       NaN -0.349171  0.669340\nJim    -0.361800  0.268390 -0.794215  1.105553  0.833369\nTravis  1.032759 -0.152801  1.406444 -0.598631  0.288329\n"}]},"apps":[],"jobName":"paragraph_1490306553793_-662018667","id":"20170323-180233_1416735870","dateCreated":"2017-03-23T18:02:33-0400","dateStarted":"2017-03-23T18:04:25-0400","dateFinished":"2017-03-23T18:04:48-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:420"},{"text":"%pyspark\nmapping = {'a': 'red', 'b': 'red', 'c': 'blue', 'd': 'blue', 'e': 'red', 'f': 'orange'}\n\nby_column = people.groupby(mapping, axis=1)\nby_column.sum()\n\nmap_series = Series(mapping)\nmap_series\n\npeople.groupby(map_series, axis=1).count()","user":"anonymous","dateUpdated":"2017-03-23T18:10:08-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"        blue  red\nJoe        2    3\nSteve      2    3\nWes        1    2\nJim        2    3\nTravis     2    3\n"}]},"apps":[],"jobName":"paragraph_1490306665788_-389046163","id":"20170323-180425_1712082883","dateCreated":"2017-03-23T18:04:25-0400","dateStarted":"2017-03-23T18:10:08-0400","dateFinished":"2017-03-23T18:10:08-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:421"},{"text":"%pyspark\npeople.groupby(len).sum()\n\nkey_list = ['one', 'one', 'one', 'two', 'two']\npeople.groupby([len, key_list]).min()","user":"anonymous","dateUpdated":"2017-03-23T18:11:00-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"              a         b         c         d         e\n3 one -0.000421  1.373888  0.157108 -0.639893 -0.535251\n  two -0.361800  0.268390 -0.794215  1.105553  0.833369\n5 one -0.752337 -0.531799 -0.426532  0.553767  1.140440\n6 two  1.032759 -0.152801  1.406444 -0.598631  0.288329\n"}]},"apps":[],"jobName":"paragraph_1490307008775_-185272097","id":"20170323-181008_2105615405","dateCreated":"2017-03-23T18:10:08-0400","dateStarted":"2017-03-23T18:11:00-0400","dateFinished":"2017-03-23T18:11:00-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:422"},{"text":"%pyspark\ncolumns = pd.MultiIndex.from_arrays([['US', 'US', 'US', 'JP', 'JP'], [1, 3, 5, 1, 3]], names=['cty', 'tenor'])\nhier_df = DataFrame(np.random.randn(4, 5), columns=columns)\nhier_df","user":"anonymous","dateUpdated":"2017-03-23T18:12:42-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cty          US                            JP          \ntenor         1         3         5         1         3\n0     -1.041323 -0.233942  0.139431  0.315995 -1.785792\n1      1.226120  0.078031 -0.025212 -0.405954  0.056555\n2     -0.006141  0.135968 -0.655892 -0.043779 -1.470567\n3     -1.038302 -1.855839 -0.091299 -0.460940  0.867787\n"}]},"apps":[],"jobName":"paragraph_1490307060537_1851096562","id":"20170323-181100_1975196575","dateCreated":"2017-03-23T18:11:00-0400","dateStarted":"2017-03-23T18:12:42-0400","dateFinished":"2017-03-23T18:12:42-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:423"},{"text":"%pyspark\nhier_df.groupby(level='cty', axis=1).count()","user":"anonymous","dateUpdated":"2017-03-23T18:13:29-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cty  JP  US\n0     2   3\n1     2   3\n2     2   3\n3     2   3\n"}]},"apps":[],"jobName":"paragraph_1490307162403_1335502388","id":"20170323-181242_949996985","dateCreated":"2017-03-23T18:12:42-0400","dateStarted":"2017-03-23T18:13:29-0400","dateFinished":"2017-03-23T18:13:29-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:424"},{"text":"%pyspark\ndf = DataFrame({'key1' : ['a','a','b','b','a'],\n                'key2' : ['one','two','one','two','one'],\n                'data1' : np.random.randn(5),\n                'data2' : np.random.randn(5)})\n                \n            \ndf","user":"anonymous","dateUpdated":"2017-03-23T18:22:37-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      data1     data2 key1 key2\n0  1.582854  0.010503    a  one\n1 -0.155180 -1.299838    a  two\n2 -0.177737 -1.156954    b  one\n3 -1.196331  0.130139    b  two\n4 -1.299236  1.304950    a  one\n"}]},"apps":[],"jobName":"paragraph_1490307209596_-308282831","id":"20170323-181329_657448957","dateCreated":"2017-03-23T18:13:29-0400","dateStarted":"2017-03-23T18:22:37-0400","dateFinished":"2017-03-23T18:22:37-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:425"},{"text":"%pyspark\ngrouped = df.groupby('key1')\ngrouped['data1'].quantile(0.9)","user":"anonymous","dateUpdated":"2017-03-23T18:22:10-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"key1\na    1.516743\nb    0.798966\nName: data1, dtype: float64\n"}]},"apps":[],"jobName":"paragraph_1490307556688_-1529030915","id":"20170323-181916_1787873124","dateCreated":"2017-03-23T18:19:16-0400","dateStarted":"2017-03-23T18:22:10-0400","dateFinished":"2017-03-23T18:22:10-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:426"},{"text":"%pyspark\ndef peak_to_peak(arr): return arr.max() - arr.min()\ngrouped.agg(peak_to_peak)","user":"anonymous","dateUpdated":"2017-03-23T18:22:54-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"         data1     data2\nkey1                    \na     2.943037  2.462945\nb     2.717135  0.044332\n"}]},"apps":[],"jobName":"paragraph_1490307730536_-1660152025","id":"20170323-182210_1128032693","dateCreated":"2017-03-23T18:22:10-0400","dateStarted":"2017-03-23T18:22:54-0400","dateFinished":"2017-03-23T18:22:54-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:427"},{"text":"%pyspark\ngrouped.describe()\n","user":"anonymous","dateUpdated":"2017-03-23T18:35:45-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"               data1     data2\nkey1                          \na    count  3.000000  3.000000\n     mean   0.329400  1.369113\n     std    1.472172  1.306333\n     min   -1.116799  0.389290\n     25%   -0.419019  0.627552\n     50%    0.278761  0.865815\n     75%    1.052500  1.859025\n     max    1.826239  2.852234\nb    count  2.000000  2.000000\n     mean  -0.287888 -0.537040\n     std    1.921304  0.031348\n     min   -1.646456 -0.559207\n     25%   -0.967172 -0.548123\n     50%   -0.287888 -0.537040\n     75%    0.391395 -0.525957\n     max    1.070679 -0.514874\n"}]},"apps":[],"jobName":"paragraph_1490307774909_1906916325","id":"20170323-182254_499493474","dateCreated":"2017-03-23T18:22:54-0400","dateStarted":"2017-03-23T18:35:45-0400","dateFinished":"2017-03-23T18:35:45-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:428"},{"text":"%pyspark\ntips = pd.read_csv('/Users/geoffnes/Downloads/tips.csv')","user":"anonymous","dateUpdated":"2017-03-23T18:39:00-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1490308545386_1710212758","id":"20170323-183545_1448306085","dateCreated":"2017-03-23T18:35:45-0400","dateStarted":"2017-03-23T18:39:00-0400","dateFinished":"2017-03-23T18:39:00-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:429"},{"text":"%pyspark\ntips['tip_pct'] = tips['tip'] / tips['total_bill']\ntips[:6]","user":"anonymous","dateUpdated":"2017-03-23T18:39:16-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   total_bill   tip     sex smoker  day    time  size   tip_pct\n0       16.99  1.01  Female     No  Sun  Dinner     2  0.059447\n1       10.34  1.66    Male     No  Sun  Dinner     3  0.160542\n2       21.01  3.50    Male     No  Sun  Dinner     3  0.166587\n3       23.68  3.31    Male     No  Sun  Dinner     2  0.139780\n4       24.59  3.61  Female     No  Sun  Dinner     4  0.146808\n5       25.29  4.71    Male     No  Sun  Dinner     4  0.186240\n"}]},"apps":[],"jobName":"paragraph_1490308740448_-1369830237","id":"20170323-183900_1747392700","dateCreated":"2017-03-23T18:39:00-0400","dateStarted":"2017-03-23T18:39:16-0400","dateFinished":"2017-03-23T18:39:16-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:430"},{"text":"%pyspark\ngrouped = tips.groupby(['sex','smoker'])\ngrouped_pct = grouped['tip_pct']\ngrouped_pct.agg('mean')","user":"anonymous","dateUpdated":"2017-03-23T18:39:35-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sex     smoker\nFemale  No        0.156921\n        Yes       0.182150\nMale    No        0.160669\n        Yes       0.152771\nName: tip_pct, dtype: float64\n"}]},"apps":[],"jobName":"paragraph_1490308756001_1039113274","id":"20170323-183916_1079889192","dateCreated":"2017-03-23T18:39:16-0400","dateStarted":"2017-03-23T18:39:35-0400","dateFinished":"2017-03-23T18:39:35-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:431"},{"text":"%pyspark\ngrouped_pct.agg(['mean','std',peak_to_peak])","user":"anonymous","dateUpdated":"2017-03-23T18:41:43-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                   mean       std  peak_to_peak\nsex    smoker                                  \nFemale No      0.156921  0.036421      0.195876\n       Yes     0.182150  0.071595      0.360233\nMale   No      0.160669  0.041849      0.220186\n       Yes     0.152771  0.090588      0.674707\n"}]},"apps":[],"jobName":"paragraph_1490308775187_-1370737653","id":"20170323-183935_1206301601","dateCreated":"2017-03-23T18:39:35-0400","dateStarted":"2017-03-23T18:41:43-0400","dateFinished":"2017-03-23T18:41:43-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:432"},{"text":"%pyspark\ngrouped_pct.agg([('foo','mean'),('bar',np.std)])\n","user":"anonymous","dateUpdated":"2017-03-23T18:41:57-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                    foo       bar\nsex    smoker                    \nFemale No      0.156921  0.036421\n       Yes     0.182150  0.071595\nMale   No      0.160669  0.041849\n       Yes     0.152771  0.090588\n"}]},"apps":[],"jobName":"paragraph_1490308903333_1593150046","id":"20170323-184143_792072419","dateCreated":"2017-03-23T18:41:43-0400","dateStarted":"2017-03-23T18:41:57-0400","dateFinished":"2017-03-23T18:41:57-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:433"},{"text":"%pyspark\nfunctions = ['count','mean','max']\nresult = grouped['tip_pct','total_bill'].agg(functions)\nresult","user":"anonymous","dateUpdated":"2017-03-23T18:42:17-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"              tip_pct                     total_bill                  \n                count      mean       max      count       mean    max\nsex    smoker                                                         \nFemale No          54  0.156921  0.252672         54  18.105185  35.83\n       Yes         33  0.182150  0.416667         33  17.977879  44.30\nMale   No          97  0.160669  0.291990         97  19.791237  48.33\n       Yes         60  0.152771  0.710345         60  22.284500  50.81\n"}]},"apps":[],"jobName":"paragraph_1490308917420_-1304763345","id":"20170323-184157_211186715","dateCreated":"2017-03-23T18:41:57-0400","dateStarted":"2017-03-23T18:42:17-0400","dateFinished":"2017-03-23T18:42:17-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:434"},{"text":"%pyspark\nresult['tip_pct']","user":"anonymous","dateUpdated":"2017-03-23T18:42:32-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"               count      mean       max\nsex    smoker                           \nFemale No         54  0.156921  0.252672\n       Yes        33  0.182150  0.416667\nMale   No         97  0.160669  0.291990\n       Yes        60  0.152771  0.710345\n"}]},"apps":[],"jobName":"paragraph_1490308937612_1289244388","id":"20170323-184217_1584294976","dateCreated":"2017-03-23T18:42:17-0400","dateStarted":"2017-03-23T18:42:32-0400","dateFinished":"2017-03-23T18:42:32-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:435"},{"text":"%pyspark\nftuples = [('Average', 'mean'), ('Standard Dev.', np.var)]\ngrouped['tip_pct','total_bill'].agg(ftuples)","user":"anonymous","dateUpdated":"2017-03-23T18:54:48-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                tip_pct               total_bill              \n                Average Standard Dev.    Average Standard Dev.\nsex    smoker                                                 \nFemale No      0.156921      0.001327  18.105185     53.092422\n       Yes     0.182150      0.005126  17.977879     84.451517\nMale   No      0.160669      0.001751  19.791237     76.152961\n       Yes     0.152771      0.008206  22.284500     98.244673\n"}]},"apps":[],"jobName":"paragraph_1490308952057_-1537105708","id":"20170323-184232_288614041","dateCreated":"2017-03-23T18:42:32-0400","dateStarted":"2017-03-23T18:54:48-0400","dateFinished":"2017-03-23T18:54:48-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:436"},{"text":"%pyspark\ngrouped.agg({'tip' : np.max, 'size' : 'sum'})","user":"anonymous","dateUpdated":"2017-03-23T18:44:16-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                tip  size\nsex    smoker            \nFemale No       5.2   140\n       Yes      6.5    74\nMale   No       9.0   263\n       Yes     10.0   150\n"}]},"apps":[],"jobName":"paragraph_1490308965253_-722360780","id":"20170323-184245_1285639354","dateCreated":"2017-03-23T18:42:45-0400","dateStarted":"2017-03-23T18:44:16-0400","dateFinished":"2017-03-23T18:44:16-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:437"},{"text":"%pyspark\ngrouped.agg({'tip_pct' : ['min', 'max', 'mean', 'std'], 'size' : 'sum'})","user":"anonymous","dateUpdated":"2017-03-23T18:48:45-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                tip_pct                               size\n                    min       max      mean       std  sum\nsex    smoker                                             \nFemale No      0.056797  0.252672  0.156921  0.036421  140\n       Yes     0.056433  0.416667  0.182150  0.071595   74\nMale   No      0.071804  0.291990  0.160669  0.041849  263\n       Yes     0.035638  0.710345  0.152771  0.090588  150\n"}]},"apps":[],"jobName":"paragraph_1490309056402_1766918631","id":"20170323-184416_191468444","dateCreated":"2017-03-23T18:44:16-0400","dateStarted":"2017-03-23T18:48:45-0400","dateFinished":"2017-03-23T18:48:45-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:438"},{"text":"%pyspark\n# Returning aggregated data in unindexed form\ntips.groupby(['sex','smoker'], as_index=False).mean()","user":"anonymous","dateUpdated":"2017-03-23T18:52:01-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      sex smoker  total_bill       tip      size   tip_pct\n0  Female     No   18.105185  2.773519  2.592593  0.156921\n1  Female    Yes   17.977879  2.931515  2.242424  0.182150\n2    Male     No   19.791237  3.113402  2.711340  0.160669\n3    Male    Yes   22.284500  3.051167  2.500000  0.152771\n"}]},"apps":[],"jobName":"paragraph_1490309325702_1220942973","id":"20170323-184845_921481167","dateCreated":"2017-03-23T18:48:45-0400","dateStarted":"2017-03-23T18:52:01-0400","dateFinished":"2017-03-23T18:52:01-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:439"},{"text":"%pyspark\n# Group-wise operations and transformations\ndf","user":"anonymous","dateUpdated":"2017-03-23T18:58:19-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      data1     data2 key1 key2\n0  1.582854  0.010503    a  one\n1 -0.155180 -1.299838    a  two\n2 -0.177737 -1.156954    b  one\n3 -1.196331  0.130139    b  two\n4 -1.299236  1.304950    a  one\n"}]},"apps":[],"jobName":"paragraph_1490309493219_1160166327","id":"20170323-185133_1543063705","dateCreated":"2017-03-23T18:51:33-0400","dateStarted":"2017-03-23T18:58:19-0400","dateFinished":"2017-03-23T18:58:19-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:440"},{"text":"%pyspark\nk1_means = df.groupby('key1').mean().add_prefix('mean_')\nk1_means","user":"anonymous","dateUpdated":"2017-03-23T18:58:32-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      mean_data1  mean_data2\nkey1                        \na       0.042813    0.005205\nb      -0.687034   -0.513408\n"}]},"apps":[],"jobName":"paragraph_1490309899287_-1093739823","id":"20170323-185819_1869290335","dateCreated":"2017-03-23T18:58:19-0400","dateStarted":"2017-03-23T18:58:32-0400","dateFinished":"2017-03-23T18:58:32-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:441"},{"text":"%pyspark\n# Returning aggregated data in unindexed form\ntips.groupby(['sex','smoker'], as_index=True).mean()","user":"anonymous","dateUpdated":"2017-03-23T18:59:23-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"               total_bill       tip      size   tip_pct\nsex    smoker                                          \nFemale No       18.105185  2.773519  2.592593  0.156921\n       Yes      17.977879  2.931515  2.242424  0.182150\nMale   No       19.791237  3.113402  2.711340  0.160669\n       Yes      22.284500  3.051167  2.500000  0.152771\n"}]},"apps":[],"jobName":"paragraph_1490309912366_1505639070","id":"20170323-185832_1614835646","dateCreated":"2017-03-23T18:58:32-0400","dateStarted":"2017-03-23T18:59:23-0400","dateFinished":"2017-03-23T18:59:23-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:442"},{"text":"%pyspark\npd.merge(df, k1_means, left_on='key1', right_index=True)","user":"anonymous","dateUpdated":"2017-03-23T19:00:31-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      data1     data2 key1 key2  mean_data1  mean_data2\n0  1.582854  0.010503    a  one    0.042813    0.005205\n1 -0.155180 -1.299838    a  two    0.042813    0.005205\n4 -1.299236  1.304950    a  one    0.042813    0.005205\n2 -0.177737 -1.156954    b  one   -0.687034   -0.513408\n3 -1.196331  0.130139    b  two   -0.687034   -0.513408\n"}]},"apps":[],"jobName":"paragraph_1490309963921_-1204639452","id":"20170323-185923_447377457","dateCreated":"2017-03-23T18:59:23-0400","dateStarted":"2017-03-23T19:00:31-0400","dateFinished":"2017-03-23T19:00:31-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:443"},{"text":"%pyspark\nkey = ['one', 'two', 'one', 'two', 'one']\npeople.groupby(key).mean()","user":"anonymous","dateUpdated":"2017-03-23T19:02:25-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"            a         b         c         d         e\none  0.691717  0.610544  0.781776 -0.529232  0.140806\ntwo -0.557068 -0.131705 -0.610373  0.829660  0.986905\n"}]},"apps":[],"jobName":"paragraph_1490310031029_1930602714","id":"20170323-190031_1518970812","dateCreated":"2017-03-23T19:00:31-0400","dateStarted":"2017-03-23T19:02:25-0400","dateFinished":"2017-03-23T19:02:25-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:444"},{"text":"%pyspark\npeople.groupby(key).transform(np.mean)","user":"anonymous","dateUpdated":"2017-03-23T19:04:16-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"               a         b         c         d         e\nJoe     0.691717  0.610544  0.781776 -0.529232  0.140806\nSteve  -0.557068 -0.131705 -0.610373  0.829660  0.986905\nWes     0.691717  0.610544  0.781776 -0.529232  0.140806\nJim    -0.557068 -0.131705 -0.610373  0.829660  0.986905\nTravis  0.691717  0.610544  0.781776 -0.529232  0.140806\n"}]},"apps":[],"jobName":"paragraph_1490310145757_-1336563996","id":"20170323-190225_1918961942","dateCreated":"2017-03-23T19:02:25-0400","dateStarted":"2017-03-23T19:04:16-0400","dateFinished":"2017-03-23T19:04:16-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:445"},{"text":"%pyspark\ndef demean(arr): return arr - arr.mean()\n\ndemeaned = people.groupby(key).transform(demean)\ndemeaned","user":"anonymous","dateUpdated":"2017-03-23T19:04:27-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"               a         b         c         d         e\nJoe    -0.692138  0.763344 -0.624668 -0.110662 -0.676057\nSteve  -0.195269 -0.400094  0.183841 -0.275893  0.153536\nWes     0.351097       NaN       NaN  0.180061  0.528534\nJim     0.195269  0.400094 -0.183841  0.275893 -0.153536\nTravis  0.341041 -0.763344  0.624668 -0.069399  0.147523\n"}]},"apps":[],"jobName":"paragraph_1490310256528_1233143259","id":"20170323-190416_1484527729","dateCreated":"2017-03-23T19:04:16-0400","dateStarted":"2017-03-23T19:04:28-0400","dateFinished":"2017-03-23T19:04:28-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:446"},{"text":"%pyspark\ndemeaned.groupby(key).mean()","user":"anonymous","dateUpdated":"2017-03-23T19:04:39-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                a    b    c             d             e\none  0.000000e+00  0.0  0.0  5.551115e-17  0.000000e+00\ntwo  2.775558e-17  0.0  0.0  0.000000e+00 -5.551115e-17\n"}]},"apps":[],"jobName":"paragraph_1490310267992_855166597","id":"20170323-190427_1671472495","dateCreated":"2017-03-23T19:04:27-0400","dateStarted":"2017-03-23T19:04:39-0400","dateFinished":"2017-03-23T19:04:39-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:447"},{"text":"%pyspark\n# Apply general split-apply-combine\n\ndef top(df, n=5, column='tip_pct'): return df.sort_index(by=column)[-n:]\n\ntop(tips, n=6)","user":"anonymous","dateUpdated":"2017-03-23T19:04:56-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"/var/folders/h4/2z0hx5wn6qzdby5b01n5x4640000gn/T/zeppelin_pyspark-4958191010723368530.py:1: FutureWarning: by argument to sort_index is deprecated, pls use .sort_values(by=...)\n  #\n     total_bill   tip     sex smoker  day    time  size   tip_pct\n109       14.31  4.00  Female    Yes  Sat  Dinner     2  0.279525\n183       23.17  6.50    Male    Yes  Sun  Dinner     4  0.280535\n232       11.61  3.39    Male     No  Sat  Dinner     2  0.291990\n67         3.07  1.00  Female    Yes  Sat  Dinner     1  0.325733\n178        9.60  4.00  Female    Yes  Sun  Dinner     2  0.416667\n172        7.25  5.15    Male    Yes  Sun  Dinner     2  0.710345\n"}]},"apps":[],"jobName":"paragraph_1490310279631_-186348675","id":"20170323-190439_1796871610","dateCreated":"2017-03-23T19:04:39-0400","dateStarted":"2017-03-23T19:04:56-0400","dateFinished":"2017-03-23T19:04:56-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:448"},{"text":"%pyspark\ntips.groupby('smoker').apply(top)","user":"anonymous","dateUpdated":"2017-03-23T19:05:09-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"            total_bill   tip     sex smoker   day    time  size   tip_pct\nsmoker                                                                   \nNo     88        24.71  5.85    Male     No  Thur   Lunch     2  0.236746\n       185       20.69  5.00    Male     No   Sun  Dinner     5  0.241663\n       51        10.29  2.60  Female     No   Sun  Dinner     2  0.252672\n       149        7.51  2.00    Male     No  Thur   Lunch     2  0.266312\n       232       11.61  3.39    Male     No   Sat  Dinner     2  0.291990\nYes    109       14.31  4.00  Female    Yes   Sat  Dinner     2  0.279525\n       183       23.17  6.50    Male    Yes   Sun  Dinner     4  0.280535\n       67         3.07  1.00  Female    Yes   Sat  Dinner     1  0.325733\n       178        9.60  4.00  Female    Yes   Sun  Dinner     2  0.416667\n       172        7.25  5.15    Male    Yes   Sun  Dinner     2  0.710345\n"}]},"apps":[],"jobName":"paragraph_1490310296825_1601994861","id":"20170323-190456_1970713542","dateCreated":"2017-03-23T19:04:56-0400","dateStarted":"2017-03-23T19:05:09-0400","dateFinished":"2017-03-23T19:05:09-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:449"},{"text":"%pyspark\ntips.groupby(['smoker','day']).apply(top, n=1, column='total_bill')","user":"anonymous","dateUpdated":"2017-03-23T19:05:36-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                 total_bill    tip     sex smoker   day    time  size  \\\nsmoker day                                                              \nNo     Fri  94        22.75   3.25  Female     No   Fri  Dinner     2   \n       Sat  212       48.33   9.00    Male     No   Sat  Dinner     4   \n       Sun  156       48.17   5.00    Male     No   Sun  Dinner     6   \n       Thur 142       41.19   5.00    Male     No  Thur   Lunch     5   \nYes    Fri  95        40.17   4.73    Male    Yes   Fri  Dinner     4   \n       Sat  170       50.81  10.00    Male    Yes   Sat  Dinner     3   \n       Sun  182       45.35   3.50    Male    Yes   Sun  Dinner     3   \n       Thur 197       43.11   5.00  Female    Yes  Thur   Lunch     4   \n\n                  tip_pct  \nsmoker day                 \nNo     Fri  94   0.142857  \n       Sat  212  0.186220  \n       Sun  156  0.103799  \n       Thur 142  0.121389  \nYes    Fri  95   0.117750  \n       Sat  170  0.196812  \n       Sun  182  0.077178  \n       Thur 197  0.115982  \n"}]},"apps":[],"jobName":"paragraph_1490310309186_-1923059238","id":"20170323-190509_716990477","dateCreated":"2017-03-23T19:05:09-0400","dateStarted":"2017-03-23T19:05:36-0400","dateFinished":"2017-03-23T19:05:36-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:450"},{"text":"%pyspark\nresult = tips.groupby('smoker')['tip_pct'].describe()\nresult","user":"anonymous","dateUpdated":"2017-03-23T19:05:51-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"smoker       \nNo      count    151.000000\n        mean       0.159328\n        std        0.039910\n        min        0.056797\n        25%        0.136906\n        50%        0.155625\n        75%        0.185014\n        max        0.291990\nYes     count     93.000000\n        mean       0.163196\n        std        0.085119\n        min        0.035638\n        25%        0.106771\n        50%        0.153846\n        75%        0.195059\n        max        0.710345\nName: tip_pct, dtype: float64\n"}]},"apps":[],"jobName":"paragraph_1490310336231_923944705","id":"20170323-190536_946842505","dateCreated":"2017-03-23T19:05:36-0400","dateStarted":"2017-03-23T19:05:51-0400","dateFinished":"2017-03-23T19:05:51-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:451"},{"text":"%pyspark\nresult.unstack('smoker')","user":"anonymous","dateUpdated":"2017-03-23T19:20:43-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"smoker          No        Yes\ncount   151.000000  93.000000\nmean      0.159328   0.163196\nstd       0.039910   0.085119\nmin       0.056797   0.035638\n25%       0.136906   0.106771\n50%       0.155625   0.153846\n75%       0.185014   0.195059\nmax       0.291990   0.710345\n"}]},"apps":[],"jobName":"paragraph_1490310351263_-355330063","id":"20170323-190551_432126561","dateCreated":"2017-03-23T19:05:51-0400","dateStarted":"2017-03-23T19:20:43-0400","dateFinished":"2017-03-23T19:20:43-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:452"},{"text":"%pyspark\nf = lambda x: x.describe()\ngrouped.apply(f)","user":"anonymous","dateUpdated":"2017-03-23T19:20:59-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                     total_bill        tip       size    tip_pct\nsex    smoker                                                   \nFemale No     count   54.000000  54.000000  54.000000  54.000000\n              mean    18.105185   2.773519   2.592593   0.156921\n              std      7.286455   1.128425   1.073146   0.036421\n              min      7.250000   1.000000   1.000000   0.056797\n              25%     12.650000   2.000000   2.000000   0.139708\n              50%     16.690000   2.680000   2.000000   0.149691\n              75%     20.862500   3.437500   3.000000   0.181630\n              max     35.830000   5.200000   6.000000   0.252672\n       Yes    count   33.000000  33.000000  33.000000  33.000000\n              mean    17.977879   2.931515   2.242424   0.182150\n              std      9.189751   1.219916   0.613917   0.071595\n              min      3.070000   1.000000   1.000000   0.056433\n              25%     12.760000   2.000000   2.000000   0.152439\n              50%     16.270000   2.880000   2.000000   0.173913\n              75%     22.120000   3.500000   2.000000   0.198216\n              max     44.300000   6.500000   4.000000   0.416667\nMale   No     count   97.000000  97.000000  97.000000  97.000000\n              mean    19.791237   3.113402   2.711340   0.160669\n              std      8.726566   1.489559   0.989094   0.041849\n              min      7.510000   1.250000   2.000000   0.071804\n              25%     13.810000   2.000000   2.000000   0.131810\n              50%     18.240000   2.740000   2.000000   0.157604\n              75%     22.820000   3.710000   3.000000   0.186220\n              max     48.330000   9.000000   6.000000   0.291990\n       Yes    count   60.000000  60.000000  60.000000  60.000000\n              mean    22.284500   3.051167   2.500000   0.152771\n              std      9.911845   1.500120   0.892530   0.090588\n              min      7.250000   1.000000   1.000000   0.035638\n              25%     15.272500   2.000000   2.000000   0.101845\n              50%     20.390000   3.000000   2.000000   0.141015\n              75%     28.572500   3.820000   3.000000   0.191697\n              max     50.810000  10.000000   5.000000   0.710345\n"}]},"apps":[],"jobName":"paragraph_1490311243609_989418249","id":"20170323-192043_2110548595","dateCreated":"2017-03-23T19:20:43-0400","dateStarted":"2017-03-23T19:20:59-0400","dateFinished":"2017-03-23T19:20:59-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:453"},{"text":"%pyspark\n# Quantile and bucket analysis\n\nframe = DataFrame({'data1': np.random.randn(1000), 'data2': np.random.randn(1000)})\nfactor = pd.cut(frame.data1, 4)\nfactor[:10]","user":"anonymous","dateUpdated":"2017-03-23T19:21:25-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0     (0.349, 2.355]\n1    (-1.656, 0.349]\n2    (-1.656, 0.349]\n3    (-1.656, 0.349]\n4     (0.349, 2.355]\n5    (-1.656, 0.349]\n6    (-1.656, 0.349]\n7    (-3.67, -1.656]\n8    (-1.656, 0.349]\n9    (-1.656, 0.349]\nName: data1, dtype: category\nCategories (4, object): [(-3.67, -1.656] < (-1.656, 0.349] < (0.349, 2.355] < (2.355, 4.361]]\n"}]},"apps":[],"jobName":"paragraph_1490311259321_-1969084610","id":"20170323-192059_323806111","dateCreated":"2017-03-23T19:20:59-0400","dateStarted":"2017-03-23T19:21:25-0400","dateFinished":"2017-03-23T19:21:25-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:454"},{"text":"%pyspark\ndef get_stats(group): return {'min': group.min(), 'max': group.max(), 'count': group.count(), 'mean': group.mean()}\n\ngrouped = frame.data2.groupby(factor)\ngrouped.apply(get_stats).unstack()","user":"anonymous","dateUpdated":"2017-03-23T19:21:38-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"                 count       max      mean       min\ndata1                                               \n(-3.67, -1.656]   61.0  2.609021  0.150625 -1.725483\n(-1.656, 0.349]  586.0  3.080514 -0.045051 -2.920185\n(0.349, 2.355]   345.0  3.032882  0.105853 -2.644108\n(2.355, 4.361]     8.0  0.999218 -0.595542 -2.084712\n"}]},"apps":[],"jobName":"paragraph_1490311285718_-1760904807","id":"20170323-192125_350358833","dateCreated":"2017-03-23T19:21:25-0400","dateStarted":"2017-03-23T19:21:38-0400","dateFinished":"2017-03-23T19:21:38-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:455"},{"text":"%pyspark\n# Return quantile numbers\ngrouping = pd.qcut(frame.data1, 10, labels=False)\n\ngrouped = frame.data2.groupby(grouping)\ngrouped.apply(get_stats).unstack()","user":"anonymous","dateUpdated":"2017-03-23T19:21:59-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"       count       max      mean       min\ndata1                                     \n0      100.0  2.609021  0.070780 -2.017273\n1      100.0  2.345962 -0.031875 -2.830138\n2      100.0  2.105239 -0.178331 -2.920185\n3      100.0  2.499579 -0.045897 -2.307751\n4      100.0  1.958704 -0.070020 -2.354367\n5      100.0  3.080514  0.126758 -2.587731\n6      100.0  2.489365 -0.051686 -2.158392\n7      100.0  2.301338 -0.008344 -2.644108\n8      100.0  2.712539  0.183017 -2.322767\n9      100.0  3.032882  0.151029 -2.440249\n"}]},"apps":[],"jobName":"paragraph_1490311298234_673416808","id":"20170323-192138_2073420820","dateCreated":"2017-03-23T19:21:38-0400","dateStarted":"2017-03-23T19:21:59-0400","dateFinished":"2017-03-23T19:21:59-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:456"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2017-03-23T19:21:59-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490311319749_-1714103359","id":"20170323-192159_1382074279","dateCreated":"2017-03-23T19:21:59-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:457"}],"name":"3-23-17 Data Aggregation lab 2","id":"2CCDG4QJC","angularObjects":{"2CA87YV9F:shared_process":[],"2CCEJM7KF:shared_process":[],"2CC5F1V5J:shared_process":[],"2CAEY7J4S:shared_process":[],"2C8XN2EJG:shared_process":[],"2C9MASHBS:shared_process":[],"2CBQH1W6G:shared_process":[],"2CB41KDFQ:shared_process":[],"2CBU9GW8D:shared_process":[],"2CAMC4YD2:shared_process":[],"2CBQEVX8B:shared_process":[],"2CB4CEBT8:shared_process":[],"2CAGQA32T:shared_process":[],"2CBACXB7D:shared_process":[],"2CBKQ3YEZ:shared_process":[],"2CAB5VAQA:shared_process":[],"2C9U5DK1N:shared_process":[],"2CC7V5ACK:shared_process":[],"2CCFZ92Z9:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}